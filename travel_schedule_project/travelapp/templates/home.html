{% extends 'base.html' %}

{% block content %}

<h1>🔎観光地を検索</h1>
<form method="get" action="{% url 'travelapp:search_touristspot' %}" class="search-form">
    <div class="search-input">
      <label for="query">検索したいキーワードを1つ入力してください</label><br>
      <input type="text" name="query" id="query" value="{{ request.GET.query }}" placeholder="例：世界遺産、京都">
      <small>施設名/都道府県名/キーワードから検索できます。</small><br>
    </div>
    <div class="search-category">
        <label for="category">カテゴリ</label><br>
        <select name="category" id="category">
            <option value="">カテゴリを選択</option>
            {% for value, name in category_choices %}
                <option value="{{ value }}" {% if value == request.GET.category %}selected{% endif %}>{{ name }}</option>
            {% endfor %}
        </select>
    </div>
    <button type="submit" class="search-btn">検索</button><br><br>
</form><br><br>

<h1>⭐おすすめ観光地</h1>
{% if tourist_spot %}
  <div class="tourist-spot">
    <div class="tourist-spot-content">
      <a href="{% url 'travelapp:detail_touristspot' pk=tourist_spot.pk %}">
        <img src="{{ tourist_spot.picture.url }}" alt="{{ tourist_spot.spot_name }}">
      </a>
      <div class="tourist-info">
        <strong>{{ tourist_spot.spot_name }}</strong><br>
        <span>{{ tourist_spot.get_prefecture_display }}{{ tourist_spot.address }}</span><br>
        
        {% if latest_review %}
          <div class="review">
            <strong>💬最新のクチコミ</strong><br>
            <span>{{ latest_review.review_title }}</span><br>
            <span>{{ latest_review.review_description }}</span><br>
          </div>
        {% endif %}
      </div>
    </div>
  </div>
{% endif %}

{% block extra_styles %}
<style>
  /* home.html専用のスタイル */
  h1 {
      font-size: 24px;
      color: #333;
  }

  /* 検索フォームを横並びに */
  .search-form {
      display: flex;
      align-items: center; /* 垂直方向で中央揃え */
      justify-content: space-between;
      gap: 20px;
      max-width: 800px;
      margin: 0 auto;
      flex-wrap: nowrap; /* 折り返さないようにする */
  }

  .search-input, .search-category {
      flex: 1; /* 各フォーム要素が平等に幅を取る */
      display: flex;
      align-items: center; /* セレクトボックスとラベルを縦に揃える */
  }

  /* 入力フィールドとセレクトボックスのスタイル調整 */
  .search-input input[type="text"], .search-category select {
      padding: 10px;
      border-radius: 5px;
      border: 1px solid #ccc;
      width: 100%;
      box-sizing: border-box; /* paddingやborderがwidthに含まれるように */
  }

  /* ボタンのスタイル調整 */
  .search-btn {
      background-color: #4CAF50;
      color: white;
      border: none;
      padding: 10px 20px; /* ボタンのパディング */
      height: 50px; /* 明示的に高さを設定 */
      border-radius: 5px;
      cursor: pointer;
      max-width: 120px; /* ボタンの最大幅 */
  }

  .search-btn:hover {
      background-color: #45a049;
  }

  small {
      font-size: 12px;
      color: #888;
  }

  /* おすすめ観光地のスタイル */
  .tourist-spot {
      display: flex;
      justify-content: center;
      margin: 20px 0;
  }

  .tourist-spot-content {
      display: flex;
      padding: 20px;
      gap: 20px;
      width: 80%;
  }

  .tourist-spot img {
      border-radius: 8px;
      width: 300px;  /* 画像を1.5倍に */
      height: 225px; /* 画像を1.5倍に */
  }

  .tourist-info {
      font-size: 14px;
      color: #555;
      flex: 1;
  }

  .tourist-info strong {
      font-size: 16px;
      color: #333;
  }

  .review {
      margin-top: 20px;
      font-size: 14px;
      color: #555;
  }

  .review strong {
      color: #333;
  }
</style>
{% endblock %}

{% endblock %}
