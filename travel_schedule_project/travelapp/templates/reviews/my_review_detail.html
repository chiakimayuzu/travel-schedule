{% extends "base.html" %}

{% block content %}
{% if messages %}
<ul class="messages">
  {% for message in messages %}
    {% if 'review_list' in message.tags %}
      <li class="{{ message.tags }}">{{ message }}</li>
    {% endif %}
  {% endfor %}
</ul>
{% endif %}

  <div class="review-detail-container">
    <h1>ğŸ’¬{{ review.user.username }} ã•ã‚“ã®ã‚¯ãƒã‚³ãƒŸè©³ç´°</h1>

    <div class="review-detail-box">
      <h2 class="spot-name">{{ review.tourist_spot.spot_name }}</h2>

      {% if review.tourist_spot.picture %}
        <img src="{{ review.tourist_spot.picture.url }}" alt="{{ review.tourist_spot.spot_name }}" class="spot-image">
      {% else %}
        <img src="/static/images/no-image.png" alt="No Image" class="spot-image">
      {% endif %}

      <div class="review-info">
        <p class="review-title">{{ review.review_title }}</p>
        <p class="review-description">{{ review.review_description }}</p>

        <p class="review-score">
          è©•ä¾¡ã‚¹ã‚³ã‚¢:
          <span class="rating-stars">
            {% for star in filled_stars %}
              <span class="star filled">&#9733;</span>
            {% endfor %}
            {% if half_star %}
              <span class="star half">&#9733;</span>
            {% endif %}
            {% for star in empty_stars %}
              <span class="star empty">&#9734;</span>
            {% endfor %}
          </span>
        </p>

        <p>è²»ç”¨: {{ review.get_review_price_display }}</p>
        <p>æ»åœ¨æ™‚é–“: {{ review.stay_time_hours }}æ™‚é–“ {{ review.stay_time_minutes }}åˆ†</p>
        <p>æŠ•ç¨¿æ—¥: {{ review.created_at|date:"Yå¹´mæœˆdæ—¥ H:i" }}</p>
        <p>æ›´æ–°æ—¥: {{ review.updated_at|date:"Yå¹´mæœˆdæ—¥ H:i" }}</p>
      </div>
    </div>

    <div class="review-buttons">
      <a href="{% url 'travelapp:edit_my_review' pk=review.id %}" class="edit-button">ç·¨é›†</a>
      <form method="post" class="delete-form" onsubmit="return confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');">
        {% csrf_token %}
        <button type="submit" name="delete" value="1" class="delete-button">ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å‰Šé™¤</button>
      </form>
    </div>

    <div class="back-link">
      <a href="{% url 'travelapp:my_review_list' %}">â† ã‚¯ãƒã‚³ãƒŸãƒªã‚¹ãƒˆã«æˆ»ã‚‹</a>
    </div>
  </div>

  {% block extra_styles %}
  <style>
    .review-detail-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      font-family: sans-serif;
    }

    .review-detail-box {
      background-color: #f9f9f9;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .spot-name {
      margin-bottom: 10px;
      font-size: 22px;
      color: #333;
    }

    .spot-image {
      width: 100%;
      height: auto;
      max-height: 300px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 16px;
    }

    .review-title {
      font-size: 18px;
      font-weight: bold;
      margin-top: 10px;
    }

    .review-description {
      margin-bottom: 12px;
      color: #555;
    }

    .review-score {
      margin: 10px 0;
    }

    /* æ˜Ÿã®å…±é€šã‚¹ã‚¿ã‚¤ãƒ« */
    .star {
      font-size: 30px;
      color: #ccc; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®ç©ºã®æ˜Ÿã‚’ã‚°ãƒ¬ãƒ¼ */
      position: relative;
      display: inline-block;
    }
    
    /* å¡—ã‚Šã¤ã¶ã—ã®æ˜Ÿ */
    .star.filled {
      color: gold; /* å®Œå…¨ã«å¡—ã‚Šã¤ã¶ã— */
    }
    
    /* åŠåˆ†å¡—ã‚Šã¤ã¶ã—ã®æ˜Ÿ */
    .star.half {
      position: relative;
    }
    
    /* åŠåˆ†å¡—ã‚Šã¤ã¶ã—ã®æ˜Ÿ - èƒŒæ™¯ã‚’ã‚°ãƒ¬ãƒ¼ã« */
    .star.half::before {
      content: 'â˜…'; /* æ˜Ÿã®å½¢ */
      position: absolute;
      left: 0;
      width: 50%;
      overflow: hidden;
      color: gold; /* å·¦åŠåˆ†ã‚’ã‚´ãƒ¼ãƒ«ãƒ‰ */
    }
    
    /* å®Œå…¨ãªç©ºã®æ˜Ÿã‚‚èƒŒæ™¯ã‚’ã‚°ãƒ¬ãƒ¼ã«ã™ã‚‹ */
    .star.empty {
      color: #ccc; /* ã‚°ãƒ¬ãƒ¼ã«è¨­å®š */
      position: relative;
    }
    
    /* ç©ºã®æ˜Ÿã‚’ã‚°ãƒ¬ãƒ¼èƒŒæ™¯ã« */
    .star.empty::before {
      content: 'â˜…'; /* æ˜Ÿã®å½¢ */
      position: absolute;
      left: 0;
      color: #ccc; /* å…¨ä½“ã‚’ã‚°ãƒ¬ãƒ¼ã«å¡—ã‚Šã¤ã¶ã™ */
    }  

    .review-buttons {
      margin-top: 20px;
      display: flex;
      gap: 20px;
    }

    .edit-button,
    .delete-button {
      padding: 8px 16px;
      border-radius: 6px;
      font-size: 14px;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .edit-button {
      background-color: rgb(206, 228, 248);
      color: #000;
    }

    .delete-button {
      background-color: #ff4d4f;
      color: #fff;
    }

    .back-link {
      margin-top: 30px;
      font-size: 14px;
    }

    .back-link a {
      color: #555;
      text-decoration: none;
    }

    .back-link a:hover {
      text-decoration: underline;
    }

    @media (max-width: 600px) {
      .review-buttons {
        flex-direction: column;
        gap: 10px;
      }
    }

    .messages {
      list-style-type: none; /* ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‰ã®ã€Œãƒ»ã€ã‚’æ¶ˆã™ */
      padding-left: 0; /* å·¦å´ã®ä½™ç™½ã‚’å‰Šé™¤ */
    }

    .messages li {
      padding: 10px;
      background-color: rgb(199, 243, 254);
      border: 1px solid rgb(199, 252, 254);
      border-radius: 6px;
      margin-bottom: 0.5rem;
    }
  </style>
{% endblock %}

{% endblock %}
