{% extends "base.html" %}

{% block content %}
<h1 style="font-size: 24px;">æ—…è¡Œãƒ—ãƒ©ãƒ³è©³ç´°</h1>

  <div>
    <br><h2 style="font-size: 20px;">{{ plan.touristplan_name }}</h2>
    <p><strong>{{ plan.start_date|date:"Yå¹´mæœˆdæ—¥ (l)" }} ï½ {{ plan.end_date|date:"Yå¹´mæœˆdæ—¥ (l)" }}</strong></p>

    
    <a href="{% url 'travelapp:touristplan_list' %}" class="back-link">æ—…è¡Œãƒ—ãƒ©ãƒ³ä¸€è¦§ã«æˆ»ã‚‹</a><br>


    <!-- ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒ©ãƒ¼ã®è¡¨ç¤º -->
    {% if form.errors %}
    <div class="alert alert-danger">
      <ul>
        {% for field, errors in form.errors.items %}
          {% for error in errors %}
            <li>{{ field }}: {{ error }}</li>
          {% endfor %}
        {% endfor %}
      </ul>
    </div>
    {% endif %}

    <br><form method="post" id="touristplanForm">
      {% csrf_token %}
      <table class="table table-bordered" id="planTable">
        <thead>
          <tr>
            <th>è¨ªå•æ—¥</th>
            <th>è¦³å…‰ã‚¹ãƒãƒƒãƒˆ</th>
          </tr>
        </thead>
        <tbody>
{% for visit in visit_date %}
  {% with modal_counter=forloop.counter %}
    <tr class="visit-row">
      <!-- è¨ªå•æ—¥ã‚»ãƒ«ã« data-visit å±æ€§ã‚’è¿½åŠ  -->
      <td data-visit="{{ visit }}">{{ visit }}</td>
      <td>
        <ul id="selectedSpot{{ modal_counter }}" class="selected-spot sortable">
          {% for spot in selected_spots %}
            {% if spot.visit_date == visit %}
              <li class="sortable-item" data-spot-id="{{ spot.id }}" data-spot-name="{{ spot.spot_name }}" data-lat="{{ spot.lat }}" data-lng="{{ spot.lng }}">
                {% if spot.picture %}
                &nbsp;&nbsp;&nbsp;&nbsp;<img src="{{ spot.picture }}" alt="{{ spot.spot_name }}" style="width:100px; height:auto;"><br>
                {% endif %}
                &nbsp;&nbsp;&nbsp;{{ spot.spot_name }}
                <br>&nbsp;&nbsp;&nbsp;{{ spot.prefecture }} {{ spot.address }}<br>
                <!-- æ»åœ¨æ™‚é–“ãŒãªã„å ´åˆã¯ã€Œæƒ…å ±ãªã—ã€ã¨è¡¨ç¤º -->
                &nbsp;&nbsp;&nbsp;å¹³å‡æ»åœ¨æ™‚é–“: 
                {% if spot.staytime_hours|default:"0" == "0" and spot.staytime_minutes|default:"0" == "0" %}
                  æƒ…å ±ãªã—
                {% else %}
                  {{ spot.staytime_hours }}æ™‚é–“{{ spot.staytime_minutes }}åˆ†
                {% endif %}
                <span class="drag-handle">â†•ï¸</span>
                <button type="button" class="delete-spot btn btn-danger btn-sm">å‰Šé™¤</button>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
        <br>
        <a href="#" class="openWantedSpotModal" data-modal-id="wantedSpotModal{{ modal_counter }}" data-target-id="selectedSpot{{ modal_counter }}">
          è¡ŒããŸã„ãƒªã‚¹ãƒˆã‹ã‚‰é¸æŠ
        </a>
      </td>
    </tr>

    

    <div id="wantedSpotModal{{ modal_counter }}" class="modal touristplan-modal">
      <div class="modal-content">
        <span class="close" onclick="closeModal()">&times;</span>

        {% if wanted_spots %}
        <h2 style="font-size: 20px;">â¤ï¸è¡ŒããŸã„ãƒªã‚¹ãƒˆã‹ã‚‰é¸æŠ</h2>
          <div class="wanted-spot-grid">
            {% for spot in wanted_spots %}
              <div class="wanted-spot-item">
                <input type="checkbox" class="wanted-checkbox"
                       data-spot-id="{{ spot.id }}"
                       data-spot-name="{{ spot.spot_name }}"
                       data-picture="{{ spot.picture }}"
                       data-category="{{ spot.category }}"
                       data-prefecture="{{ spot.prefecture }}"
                       data-address="{{ spot.address }}"
                       data-staytime-hours="{{ spot.staytime_hours }}"
                       data-staytime-minutes="{{ spot.staytime_minutes }}"
                       data-lat="{{ spot.lat }}"
                       data-lng="{{ spot.lng }}"
                       {# åŒã˜ visit_date ã«å¯¾ã—ã¦ã€ã™ã§ã«è¿½åŠ ã•ã‚Œã¦ã„ã‚‹è¦³å…‰åœ°ãªã‚‰ãƒã‚§ãƒƒã‚¯ã‚’ä¿æŒ #}
                       {% for date, names in selected_spot_names_by_date.items %}
                         {% if date == visit_date and spot.spot_name in names %}
                           checked
                         {% endif %}
                       {% endfor %}>
                <strong>{{ spot.spot_name }}</strong><br>
                {% if spot.picture %}
                  <img src="{{ spot.picture }}" alt="{{ spot.spot_name }}" style="width: 100px; height: auto;"><br>
                {% endif %}
                ã‚«ãƒ†ã‚´ãƒª: {{ spot.category }}<br>
                ä½æ‰€: {{ spot.prefecture }}{{ spot.address }}<br>
                å¹³å‡æ»åœ¨æ™‚é–“: 
                {% if spot.staytime_hours|default:"0" == "0" and spot.staytime_minutes|default:"0" == "0" %}
                  æƒ…å ±ãªã—
                {% else %}
                  {{ spot.staytime_hours }}æ™‚é–“{{ spot.staytime_minutes }}åˆ†
                {% endif %}
              </div>
            {% endfor %}
          </div>
          <br><button type="button" class="btn btn-success confirmSelection" style="background-color: rgb(69, 110, 160); color: white;">ãƒ—ãƒ©ãƒ³ã«è¿½åŠ </button>
        {% else %}
        <h2 style="font-size: 20px;">â¤ï¸è¡ŒããŸã„ãƒªã‚¹ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“</h2>
        <br><p style="color: gray;">è¦³å…‰åœ°ã‚’æ¤œç´¢ã—ã¦ã€Œè¡ŒããŸã„ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ãƒªã‚¹ãƒˆã«è¿½åŠ ã•ã‚Œã¾ã™</p>
          <br><p><a href="{% url 'travelapp:home' %}" class="search-btn">ğŸ”è¦³å…‰åœ°ã‚’æ¢ã™</a></p>

        {% endif %}
      </div>
    </div>
    
              
                
              </div>
            {% endwith %}
          {% endfor %}
        </tbody>
      </table>

      <!-- ä¿å­˜ãƒœã‚¿ãƒ³ -->
      <button type="submit" class="save-button">ä¿å­˜</button>
    </form>

    <br><a href="{% url 'travelapp:touristplan_list' %}" class="back-link">æ—…è¡Œãƒ—ãƒ©ãƒ³ä¸€è¦§ã«æˆ»ã‚‹</a><br>
  </div>

  <!-- Google Maps APIã®èª­ã¿è¾¼ã¿ -->
  <br><script src="https://maps.googleapis.com/maps/api/js?key={{ google_maps_api_key }}&callback=initMap" async defer></script>
  <div id="map" style="height: 500px;"></div>

<!-- JavaScriptéƒ¨åˆ† --> 
<script>
  // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«å…¨ã¦ã®é¸æŠæ¸ˆã¿ãƒªã‚¹ãƒˆã«å¯¾ã—ã¦Sortableã‚’åˆæœŸåŒ–
  document.addEventListener("DOMContentLoaded", function() {
    document.querySelectorAll('.selected-spot').forEach(function(list) {
      new Sortable(list, { handle: ".drag-handle", animation: 150 });
    });
  });

  // å‰Šé™¤ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆï¼ˆå‹•çš„ã«è¿½åŠ ã•ã‚ŒãŸã‚‚ã®ã‚‚å¯¾è±¡ï¼‰
  document.addEventListener("click", function(e) {
    if (e.target.classList.contains("delete-spot")) {
      // å‰Šé™¤å¯¾è±¡ã®liè¦ç´ ã‚’å–å¾—ã—ã¦å‰Šé™¤
      var li = e.target.closest("li.sortable-item");
      if(li) {
        var spotId = li.getAttribute("data-spot-id");
        li.remove();
        // ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®åŒã˜ã‚¹ãƒãƒƒãƒˆã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã‚’ã‚ªãƒ•ã«ã™ã‚‹
        document.querySelectorAll('.wanted-checkbox[data-spot-id="' + spotId + '"]').forEach(function(checkbox) {
          checkbox.checked = false;
        });
      }
    }
  });

  // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ãéš›ã«ã€é¸æŠæ¸ˆã¿ãƒªã‚¹ãƒˆã®çŠ¶æ…‹ã‚’åæ˜ ã™ã‚‹å‡¦ç†ã‚’è¿½åŠ 
  function openModal(modalId) {
    var modal = document.getElementById(modalId);
    modal.style.display = 'block';
    
    // currentTargetId ã¯ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ããƒªãƒ³ã‚¯ã‚¯ãƒªãƒƒã‚¯æ™‚ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹å‰æã§ã™
    var selectedList = document.getElementById(currentTargetId);
    if (selectedList) {
      // é¸æŠæ¸ˆã¿ãƒªã‚¹ãƒˆã‹ã‚‰ã€è¿½åŠ æ¸ˆã¿ã® spotId ã‚’åé›†
      var addedSpotIds = [];
      selectedList.querySelectorAll('.sortable-item').forEach(function(item){
        addedSpotIds.push(item.getAttribute('data-spot-id'));
      });
      // ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã«ã¤ã„ã¦ã€spotId ãŒæ—¢ã«è¿½åŠ æ¸ˆã¿ãªã‚‰ãƒã‚§ãƒƒã‚¯ã‚’ä»˜ã‘ã‚‹
      modal.querySelectorAll('.wanted-checkbox').forEach(function(checkbox){
        var spotId = checkbox.getAttribute('data-spot-id');
        if (addedSpotIds.indexOf(spotId) !== -1) {
          checkbox.checked = true;
        }
      });
    }
  }
  
  function closeModal() {
    document.querySelectorAll('.modal').forEach(modal => modal.style.display = 'none');
  }

  // ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚’é–‹ã
  document.querySelectorAll('.openWantedSpotModal').forEach(function (link) {
    link.addEventListener('click', function (e) {
      e.preventDefault();
      currentTargetId = this.getAttribute('data-target-id');
      var modalId = this.getAttribute('data-modal-id');
      openModal(modalId);
    });
  });

  // ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã®ã€Œé¸æŠå®Œäº†ã€ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®å‡¦ç†
  document.querySelectorAll('.confirmSelection').forEach(function (button) {
    button.addEventListener('click', function () {
      var modal = this.closest('.modal');
      var checkedItems = modal.querySelectorAll('.wanted-checkbox:checked');

      var selectedList = document.getElementById(currentTargetId);
      selectedList.innerHTML = "";  // ãƒªã‚¹ãƒˆã‚’ã‚¯ãƒªã‚¢

      checkedItems.forEach(function (checkbox) {
        var spotId = checkbox.getAttribute('data-spot-id');
        var spotName = checkbox.getAttribute('data-spot-name');
        var spotPicture = checkbox.getAttribute('data-picture');
        var spotCategory = checkbox.getAttribute('data-category');
        var spotPrefecture = checkbox.getAttribute('data-prefecture');
        var spotAddress = checkbox.getAttribute('data-address');
        var spotStaytimeHours = checkbox.getAttribute('data-staytime-hours');
        var spotStaytimeMinutes = checkbox.getAttribute('data-staytime-minutes');
        var spotLat = checkbox.getAttribute('data-lat');
        var spotLng = checkbox.getAttribute('data-lng');

        // liã‚¿ã‚°ã«dataå±æ€§ã‚’è¨­å®šã™ã‚‹
        var listItem = document.createElement("li");
        listItem.classList.add("sortable-item");
        listItem.setAttribute("data-spot-id", spotId);
        listItem.setAttribute("data-spot-name", spotName);
        listItem.setAttribute("data-lat", spotLat);
        listItem.setAttribute("data-lng", spotLng);

        // æ»åœ¨æ™‚é–“ã®è¡¨ç¤ºã‚’æ¡ä»¶ã«å¿œã˜ã¦å¤‰æ›´
let staytimeDisplay = "æƒ…å ±ãªã—";
if (
  (spotStaytimeHours !== "0" && spotStaytimeHours !== "" && spotStaytimeHours !== null) ||
  (spotStaytimeMinutes !== "0" && spotStaytimeMinutes !== "" && spotStaytimeMinutes !== null)
) {
  staytimeDisplay = `${spotStaytimeHours || 0}æ™‚é–“${spotStaytimeMinutes || 0}åˆ†`;
}

listItem.innerHTML = `
  <strong>${spotName}</strong><br>
  ${spotPicture ? `<img src="${spotPicture}" alt="${spotName}" style="width: 100px; height: auto;"><br>` : ''}
  ã‚«ãƒ†ã‚´ãƒª: ${spotCategory}<br>
  éƒ½é“åºœçœŒ: ${spotPrefecture}<br>
  ä½æ‰€: ${spotAddress}<br>
  å¹³å‡æ»åœ¨æ™‚é–“: ${staytimeDisplay}
  <span class="drag-handle">â†•ï¸</span>
  <button type="button" class="delete-spot btn btn-danger btn-sm">å‰Šé™¤</button>
`;

        selectedList.appendChild(listItem);
      });

      closeModal();
      // ãƒ¢ãƒ¼ãƒ€ãƒ«å†…ã§ä¸¦ã³æ›¿ãˆãŒè¡Œã‚ã‚ŒãŸå¾Œã¯ã€å†åˆæœŸåŒ–
      new Sortable(selectedList, { handle: ".drag-handle", animation: 150 });
      
      // é¸æŠãƒªã‚¹ãƒˆã®å¤‰æ›´ã‚’ãƒãƒƒãƒ—ã«åæ˜ 
      updateMapMarkers(currentTargetId);
    });
  });

  // ãƒ•ã‚©ãƒ¼ãƒ é€ä¿¡æ™‚ã«ã€å„è¡Œã®è¨ªå•æ—¥ã¨ãã®æ—¥ã®ã‚¹ãƒãƒƒãƒˆIDã‚’å€‹åˆ¥ã®hidden inputã¨ã—ã¦è¿½åŠ ã™ã‚‹
  document.getElementById('touristplanForm').addEventListener('submit', function (e) {
    // ã™ã§ã«è¿½åŠ ã•ã‚ŒãŸhidden inputãŒã‚ã‚Œã°å‰Šé™¤ã™ã‚‹
    var existingInputs = document.querySelectorAll('.dynamic-hidden');
    existingInputs.forEach(function(input){
      input.remove();
    });

    // å„è¡Œï¼ˆè¨ªå•æ—¥ã”ã¨ï¼‰ã®å‡¦ç†
    document.querySelectorAll('.visit-row').forEach(function(row) {
      // 1åˆ—ç›®ã®ã‚»ãƒ«ã‹ã‚‰è¨ªå•æ—¥ã‚’å–å¾—ï¼ˆdata-visitå±æ€§ï¼‰
      var visitDate = row.querySelector('td[data-visit]').getAttribute('data-visit');
      // ãã®è¡Œå†…ã® selected-spot ãƒªã‚¹ãƒˆã‚’å–å¾—
      var spotList = row.querySelector('.selected-spot');
      if (spotList) {
        // å„ã‚¹ãƒãƒƒãƒˆã«ã¤ã„ã¦hidden inputã‚’ä½œæˆ
        spotList.querySelectorAll('.sortable-item').forEach(function(item) {
          var spotId = item.getAttribute('data-spot-id');
          // hidden input for spot id
          var inputSpot = document.createElement('input');
          inputSpot.type = 'hidden';
          inputSpot.name = 'selected_spot_ids';
          inputSpot.value = spotId;
          inputSpot.classList.add('dynamic-hidden');
          // hidden input for visit date (åŒã˜è¨ªå•æ—¥ã‚’å¯¾å¿œã™ã‚‹ã‚¹ãƒãƒƒãƒˆã«è¨­å®š)
          var inputVisit = document.createElement('input');
          inputVisit.type = 'hidden';
          inputVisit.name = 'visit_dates';
          inputVisit.value = visitDate;
          inputVisit.classList.add('dynamic-hidden');
          // ãƒ•ã‚©ãƒ¼ãƒ ã«è¿½åŠ 
          this.appendChild(inputSpot);
          this.appendChild(inputVisit);
        }.bind(this));  // this ã¯ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ 
      }
    }.bind(this));  // this ã¯ãƒ•ã‚©ãƒ¼ãƒ è¦ç´ 
  });


    // ä»¥é™ã¯Google Mapé–¢é€£ã®å‡¦ç†
    let map;
    let markers = [];
    let selectedMarker = null;  // ç¾åœ¨é¸æŠã•ã‚Œã¦ã„ã‚‹ãƒãƒ¼ã‚«ãƒ¼
    let selectedSpotId = null;   // ç¾åœ¨é¸æŠã•ã‚Œã¦ã„ã‚‹è¦³å…‰åœ°ID

    // Google MapåˆæœŸåŒ–
    function initMap() {
      var center = { lat: 35.6895, lng: 139.6917 };
      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 10,
        center: center
      });
      
      // ã‚µãƒ¼ãƒã‚µã‚¤ãƒ‰ã§æ—¢ã«é¸æŠæ¸ˆã¿ã®è¦³å…‰åœ°ã‚‚ãƒ”ãƒ³è¡¨ç¤º
      {% for spot in selected_spots %}
        addMarker({ lat: {{ spot.lat }}, lng: {{ spot.lng }} }, "{{ spot.id }}", "{{ spot.spot_name }}", "{{ spot.address }}", {{ spot.staytime_hours }}, {{ spot.staytime_minutes }});
      {% endfor %}
      
      setListClickHandlers();
      setDeleteButtonHandlers(); 
    }

    function addMarker(position, spotId, title, address, stayHours, stayMinutes) {
      var marker = new google.maps.Marker({
        position: position,
        map: map,
        title: title
      });
      marker.spotId = spotId;
      var infowindow = new google.maps.InfoWindow({
        content: `<h3 style="font-size: 16px; margin: 0;">${title}</h3>`
      });
      marker.addListener('click', function () {
        infowindow.open(map, marker);
        selectSpot(spotId);
      });
      markers.push(marker);
    }

    function selectSpot(spotId) {
      if (selectedSpotId) {
        var prevSelectedItem = document.querySelector('.selected-spot [data-spot-id="' + selectedSpotId + '"]');
        if (prevSelectedItem) {
          prevSelectedItem.classList.remove('selected-item');
        }
        const prevMarker = markers.find(m => m.spotId === selectedSpotId);
        if (prevMarker) {
          prevMarker.setIcon(null);
        }
      }
      selectedMarker = markers.find(m => m.spotId === spotId);
      const selectedItem = document.querySelector('.selected-spot [data-spot-id="' + spotId + '"]');
      if (selectedMarker) {
        selectedMarker.setIcon('http://maps.google.com/mapfiles/ms/icons/blue-dot.png');
      }
      if (selectedItem) {
        selectedItem.classList.add('selected-item');
      }
      selectedSpotId = spotId;
    }

    function updateMapMarkers(listId) {
      markers.forEach(function(marker) {
        marker.setMap(null);
      });
      markers = [];
      var listItems = document.getElementById(listId).querySelectorAll('.sortable-item');
      listItems.forEach(function(item) {
        var spotId = item.getAttribute('data-spot-id');
        var lat = parseFloat(item.getAttribute('data-lat'));
        var lng = parseFloat(item.getAttribute('data-lng'));
        var spotName = item.getAttribute('data-spot-name');
        addMarker({lat: lat, lng: lng}, spotId, spotName, "", 0, 0);
      });
      setListClickHandlers();
      setDeleteButtonHandlers(); 
    }

    function setListClickHandlers() {
      document.querySelectorAll('.selected-spot .sortable-item').forEach(function(item) {
        item.addEventListener('click', function(e) {
          if(e.target.classList.contains('drag-handle')) return;
          var spotId = item.getAttribute('data-spot-id');
          var marker = markers.find(m => m.spotId === spotId);
          if(marker) {
            map.panTo(marker.getPosition());
            map.setZoom(14);
            google.maps.event.trigger(marker, 'click');
            document.getElementById('map').scrollIntoView({ behavior: 'smooth' });
          }
        });
      });
    }

    // ãƒãƒ¼ã‚«ãƒ¼ã‚’å‰Šé™¤ã™ã‚‹é–¢æ•°
function removeMarker(spotId) {
  const markerIndex = markers.findIndex(m => m.spotId === spotId);
  if (markerIndex !== -1) {
    markers[markerIndex].setMap(null); // ãƒãƒƒãƒ—ã‹ã‚‰å‰Šé™¤
    markers.splice(markerIndex, 1);    // é…åˆ—ã‹ã‚‰ã‚‚å‰Šé™¤
  }
}

// å‰Šé™¤ãƒœã‚¿ãƒ³ã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã¤ã‘ã‚‹
function setDeleteButtonHandlers() {
  document.querySelectorAll('.delete-spot').forEach(button => {
    button.addEventListener('click', function() {
      const item = this.closest('.sortable-item'); // ä¸€ç•ªè¿‘ã„ã‚¹ãƒãƒƒãƒˆè¦ç´ ã‚’å–å¾—
      const spotId = item.getAttribute('data-spot-id');

      // DOMã‹ã‚‰å‰Šé™¤
      item.remove();

      // ãƒãƒƒãƒ—ã®ãƒãƒ¼ã‚«ãƒ¼å‰Šé™¤
      removeMarker(spotId);
    });
  });
}


    google.maps.event.addDomListener(window, 'load', initMap);
  </script>
  {% block extra_styles %}
<!-- CSSéƒ¨åˆ† -->

<style>
  .sortable { list-style: none; padding: 0; }
  .sortable-item { display: flex; align-items: center; padding: 5px; border: 1px solid #ddd; margin: 5px 0; background: #f9f9f9; cursor: grab; }
  .drag-handle { margin-left: auto; cursor: grab; }
  .delete-spot { margin-left: 5px; }

  .modal {
    display: none;
    position: fixed;
    z-index: 1050; /* ã“ã“ã‚’èª¿æ•´ */
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.4);
  }

  /* base.html ã®ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¹ã‚¿ã‚¤ãƒ«ã‚’é©ç”¨ */
  .travelapp-base-modal .modal-dialog {
    max-width: 500px;
    margin: 1.75rem auto;
  }

  .travelapp-base-modal .modal-content {
    border-radius: 0.3rem;
  }

  .travelapp-base-modal .modal-header {
    background-color: #f8f9fa;
    border-bottom: 1px solid #e1e1e1;
  }

  .travelapp-base-modal .modal-title {
    font-size: 1.25rem;
    font-weight: bold;
  }

  .travelapp-base-modal .close {
    font-size: 1.5rem;
    color: #000;
  }

  .travelapp-base-modal .modal-footer {
    background-color: #f8f9fa;
    border-top: 1px solid #e1e1e1;
  }

  .travelapp-base-modal .modal-body {
    padding: 20px;
  }

  .save-button {
    background-color: rgb(69, 110, 160);  
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 6px;
    cursor: pointer;
  }

  .save-button:hover {
    background-color: rgb(89, 130, 180);
  }

  .back-link {
    color: #555;
    text-decoration: none;
    font-size: 16px;
    transition: text-decoration 0.2s ease;
  }

  .back-link:hover {
    text-decoration: underline;
    color: #555;
  }

  .sortable-item {
    display: flex;
    align-items: center;
  }

  .drag-handle {
    margin-right: 20px;
  }

  .delete-spot {
    margin-left: 10px;
  }

  .wanted-spot-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 15px;
  }

  .wanted-spot-item {
    border: 1px solid #ccc;
    padding: 10px;
    border-radius: 8px;
    background-color: #f9f9f9;
  }

  /* ãƒ¢ãƒ¼ãƒ€ãƒ«ã®ç‰¹åˆ¥ãªã‚¹ã‚¿ã‚¤ãƒ« */
  .touristplan-modal {
    z-index: 1050; /* æœ€å‰é¢ã«é…ç½® */
    display: none; /* åˆæœŸçŠ¶æ…‹ã¯éè¡¨ç¤º */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
  }

  .touristplan-modal .modal-dialog {
    max-width: 800px;
    margin: 1.75rem auto;
  }

  .touristplan-modal .modal-content {
    background-color: white;
    border-radius: 10px;
    padding: 20px;
    width: 100%;
    max-width: 1000px;
    max-height: 80vh;
    overflow-y: auto;
    border: 1px solid #888;
  
    position: fixed;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%); /* â† ä¸­å¤®ã«ç§»å‹• */
  }

  .touristplan-modal .modal-header {
    background-color: #f8f9fa;
    border-bottom: 1px solid #e1e1e1;
    position: relative; /* Ã—ãƒœã‚¿ãƒ³ã‚’å³ä¸Šã«é…ç½®ã™ã‚‹ãŸã‚ã«èª¿æ•´ */
  }

  /* Ã—ãƒœã‚¿ãƒ³ã‚’å³ä¸Šã«é…ç½® */
  .touristplan-modal .close {
    font-size: 1.5rem;
    color: #000;
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
  }

  .touristplan-modal .modal-title {
    font-size: 1.25rem;
    font-weight: bold;
  }

  .touristplan-modal .modal-footer {
    background-color: #f8f9fa;
    border-top: 1px solid #e1e1e1;
  }

  .touristplan-modal .modal-body {
    padding: 20px;
  }

  .drag-handle {
    font-size: 28px;
  }

  .drag-handle:hover {
    font-size: 34px;
  }

  .search-btn {
    background-color: #ff4d6d;
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-size: 16px;
    text-decoration: none;
    display: inline-block;
  }

  .search-btn:hover {
    background-color: #ff6b81;
    color: white;
    text-decoration: none;
  }
</style>

  
  
{% endblock %}
{% endblock %}
